<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tasnim Jahan ‚Äî Will you be my Valentine?</title>
  <style>
    :root{
      --ink:#2a2a2a;
      --card:#ffffffcc;
      --shadow: 0 18px 60px rgba(0,0,0,.12);
      --pink:#ff4d8d;
      --pink2:#ff2d6d;
      --mint:#66d1b5;
      --sky:#b9e6ff;
      --lav:#d8c8ff;
      --peach:#ffd1b8;
      --cream:#fff5e8;
      --storm:#0b1020;
      --danger:#ff3b3b;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--ink);
      overflow:hidden;
      background: #fff;
    }

    /* === Scene Backgrounds (hand-painted pastel vibe) === */
    .scene{
      position:fixed;
      inset:0;
      z-index:0;
      transition: filter .8s ease, transform .8s ease;
    }

    .bgBase{
      position:absolute; inset:0;
      background:
        radial-gradient(1200px 700px at 18% 18%, rgba(216,200,255,.85), transparent 60%),
        radial-gradient(1100px 700px at 82% 28%, rgba(185,230,255,.9), transparent 60%),
        radial-gradient(900px 700px at 50% 90%, rgba(255,209,184,.85), transparent 55%),
        linear-gradient(135deg, rgba(255,245,232,1), rgba(255,237,243,1));
      filter:saturate(1.05) contrast(1.02);
    }

    /* film grain */
    .grain{
      position:absolute; inset:-40px;
      background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.16'/%3E%3C/svg%3E");
      mix-blend-mode: soft-light;
      opacity:.35;
      pointer-events:none;
      animation: grainMove 7s steps(2) infinite;
    }
    @keyframes grainMove{
      0%{transform:translate(0,0)}
      25%{transform:translate(-10px,6px)}
      50%{transform:translate(-2px,-12px)}
      75%{transform:translate(12px,2px)}
      100%{transform:translate(0,0)}
    }

    /* clouds layer */
    .clouds{
      position:absolute; inset:0;
      pointer-events:none;
      opacity:.9;
      filter: blur(.2px);
    }
    .cloud{
      position:absolute;
      width: 240px;
      height: 90px;
      background: rgba(255,255,255,.65);
      border-radius: 100px;
      box-shadow: 0 16px 40px rgba(0,0,0,.06);
      border: 1px solid rgba(255,255,255,.5);
      backdrop-filter: blur(6px);
    }
    .cloud:before, .cloud:after{
      content:"";
      position:absolute;
      background: rgba(255,255,255,.72);
      width: 110px; height: 110px;
      border-radius: 50%;
      top: -55px; left: 35px;
    }
    .cloud:after{
      width: 130px; height: 130px;
      top: -70px; left: 95px;
      background: rgba(255,255,255,.62);
    }

    .c1{ top:12%; left:-18%; transform:scale(1.00); animation: drift1 26s linear infinite; }
    .c2{ top:25%; left:-26%; transform:scale(1.25); animation: drift2 34s linear infinite; opacity:.82;}
    .c3{ top:48%; left:-22%; transform:scale(.95); animation: drift3 29s linear infinite; opacity:.75;}
    @keyframes drift1{ to{ transform: translateX(140vw) scale(1.00); } }
    @keyframes drift2{ to{ transform: translateX(150vw) scale(1.25); } }
    @keyframes drift3{ to{ transform: translateX(145vw) scale(.95); } }

    /* floating petals/hearts background particles */
    .bgParticles{
      position:absolute; inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .bgP{
      position:absolute;
      top:-10vh;
      opacity:.9;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.08));
      will-change: transform, opacity;
    }

    /* === Card UI === */
    .card{
      width:min(620px, 92vw);
      background:var(--card);
      backdrop-filter: blur(12px);
      border:1px solid rgba(255,255,255,.65);
      border-radius:28px;
      box-shadow:var(--shadow);
      padding:26px 22px 18px;
      text-align:center;
      position:relative;
      z-index:2;
    }

    .gif{
      width:230px;
      height:230px;
      border-radius:22px;
      overflow:hidden;
      margin:0 auto 14px;
      box-shadow: 0 14px 40px rgba(255,77,141,.18);
      border: 1px solid rgba(255,77,141,.22);
      background:#fff;
      display:grid;
      place-items:center;
    }
    .gif img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    h1{
      margin:8px 0 10px;
      font-size: clamp(22px, 4.2vw, 34px);
      letter-spacing:.2px;
      line-height:1.15;
    }
    .sub{
      margin:0 0 6px;
      opacity:.85;
      font-size:15px;
    }

    .btnRow{
      margin-top:14px;
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
    }

    button{
      border:0;
      padding:12px 18px;
      border-radius:999px;
      font-weight:800;
      cursor:pointer;
      font-size:16px;
      transition: transform .08s ease, box-shadow .2s ease, background .2s ease, opacity .2s ease;
      box-shadow: 0 12px 30px rgba(0,0,0,.08);
      user-select:none;
    }
    button:active{transform: translateY(1px) scale(.99)}
    button:disabled{opacity:.5; cursor:not-allowed}

    .yes{
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:white;
    }
    .yes:hover{box-shadow: 0 16px 38px rgba(255,45,109,.26)}
    .no{
      background:white;
      color:var(--pink2);
      border:1px solid rgba(255,45,109,.25);
    }
    .no:hover{box-shadow: 0 16px 38px rgba(255,45,109,.12)}

    .msg{
      margin-top:12px;
      min-height:36px;
      font-size:18px;
      font-weight:750;
    }

    .tiny{
      margin-top:10px;
      font-size:12.5px;
      opacity:.68;
    }

    /* Foreground shower (Yes celebrations) */
    .float{
      position:fixed;
      top:-10vh;
      left:0;
      will-change: transform, opacity;
      z-index:3;
      pointer-events:none;
      filter: drop-shadow(0 8px 14px rgba(0,0,0,.12));
      font-size:22px;
      opacity:.95;
    }

    /* Modal */
    .overlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.34);
      display:none;
      place-items:center;
      z-index:10;
      padding:16px;
    }
    .modal{
      width:min(460px, 92vw);
      background:#fff;
      border-radius:22px;
      padding:18px 18px 16px;
      box-shadow: var(--shadow);
      text-align:center;
    }
    .modal h2{margin:6px 0 10px; font-size:22px}
    .modal p{margin:0 0 14px; opacity:.9}
    .small{font-size:13px; opacity:.75; margin-top:10px}

    /* Disaster mode overlay */
    .disaster{
      position:absolute; inset:0;
      background:
        radial-gradient(900px 650px at 30% 25%, rgba(255,0,76,.20), transparent 55%),
        radial-gradient(1100px 800px at 75% 35%, rgba(255,153,0,.18), transparent 60%),
        linear-gradient(180deg, rgba(10,10,20,1), rgba(0,0,0,1));
      opacity:0;
      pointer-events:none;
      transition: opacity .8s ease;
    }
    .disaster.active{opacity:1;}

    .shake{
      animation: shake .12s infinite;
    }
    @keyframes shake{
      0%{ transform: translate(0,0) rotate(0deg);}
      25%{ transform: translate(2px,-1px) rotate(-0.2deg);}
      50%{ transform: translate(-2px,1px) rotate(0.2deg);}
      75%{ transform: translate(1px,2px) rotate(-0.2deg);}
      100%{ transform: translate(0,0) rotate(0deg);}
    }

    .meteor{
      position:fixed;
      width:180px;
      height:2px;
      background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,220,180,.9), rgba(255,120,120,.9));
      border-radius:999px;
      opacity:.9;
      z-index:4;
      pointer-events:none;
      filter: drop-shadow(0 10px 14px rgba(255,80,80,.25));
    }

    .boomText{
      position:fixed;
      inset:0;
      display:grid;
      place-items:center;
      z-index:20;
      pointer-events:none;
      opacity:0;
      transition: opacity .6s ease;
      text-align:center;
      padding:20px;
    }
    .boomText.active{opacity:1;}
    .boomText .inner{
      background: rgba(0,0,0,.55);
      color: #fff;
      border: 1px solid rgba(255,255,255,.22);
      border-radius: 22px;
      padding: 16px 18px;
      box-shadow: 0 18px 60px rgba(0,0,0,.25);
    }
    .boomText h3{
      margin: 0 0 6px;
      font-size: clamp(20px, 4.5vw, 34px);
      color: #fff;
    }
    .boomText p{
      margin:0;
      opacity:.9;
      font-size: 15px;
    }

    /* helper badge */
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(255,45,109,.22);
      background: rgba(255,255,255,.7);
      font-size:13px;
      font-weight:700;
      opacity:.9;
      margin-top:10px;
    }
    .dot{
      width:10px; height:10px; border-radius:50%;
      background: linear-gradient(135deg, var(--mint), var(--pink));
      box-shadow: 0 10px 20px rgba(102,209,181,.25);
    }

    /* Spring romance state (after Forever = Yes) */
    body.spring .bgBase{
      background:
        radial-gradient(1200px 700px at 18% 18%, rgba(185,230,255,.92), transparent 60%),
        radial-gradient(1100px 700px at 78% 22%, rgba(216,200,255,.95), transparent 60%),
        radial-gradient(900px 700px at 50% 95%, rgba(255,224,245,.95), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,1), rgba(255,245,232,1));
      filter:saturate(1.08) contrast(1.03);
    }

    body.disaster .card{
      border-color: rgba(255,80,80,.3);
      box-shadow: 0 18px 70px rgba(255,30,30,.14);
    }
  </style>
</head>
<body>
  <!-- Background scene -->
  <div class="scene" id="scene">
    <div class="bgBase"></div>

    <div class="clouds" id="clouds">
      <div class="cloud c1"></div>
      <div class="cloud c2"></div>
      <div class="cloud c3"></div>
    </div>

    <div class="bgParticles" id="bgParticles"></div>

    <div class="grain"></div>
    <div class="disaster" id="disasterOverlay"></div>
  </div>

  <div class="card" id="card">
    <div class="gif">
      <!-- Replace with any GIF you like -->
      <img
        src="https://media.giphy.com/media/3oriO0OEd9QIDdllqo/giphy.gif"
        alt="Cute valentine gif"
      />
    </div>

    <h1 id="question">Tasnim Jahan, will you be my Valentine? üíå</h1>
    <div class="sub" id="subtitle">I promise: premium vibes, zero stress, maximum cute.</div>

    <div class="btnRow" id="mainButtons">
      <button class="yes" id="yesBtn">Yes üíñ</button>
      <button class="no" id="noBtn">No üôà</button>
    </div>

    <div class="btnRow" id="foreverButtons" style="display:none;">
      <button class="yes" id="foreverYesBtn">Yes, forever üíû</button>
      <button class="no" id="foreverNoBtn">No üòÖ</button>
    </div>

    <div class="msg" id="msg"></div>

    <div class="pill" title="Music starts after your first click (browser rules).">
      <span class="dot"></span>
      <span id="musicStatus">Music: off (click any button to start)</span>
    </div>

    <div class="tiny">Tip: You can swap the GIF by changing the <code>src</code> link.</div>
  </div>

  <!-- Are you sure modal -->
  <div class="overlay" id="overlay">
    <div class="modal">
      <h2>Are you sure? ü•∫</h2>
      <p id="noLine">I‚Äôll be a little sad‚Ä¶ like a kitten in the rain.</p>
      <div class="btnRow">
        <button class="yes" id="reconsiderBtn">Okay‚Ä¶ YES üíò</button>
        <button class="no" id="stillNoBtn">Still No üò∂</button>
      </div>
      <div class="small">(Think carefully. Very carefully. The universe is watching.)</div>
    </div>
  </div>

  <!-- disaster end screen -->
  <div class="boomText" id="boomText">
    <div class="inner">
      <h3>MISSION FAILED üí•üåç</h3>
      <p>Earth has exploded. Love initiative terminated. (Try again in a new timeline.)</p>
    </div>
  </div>

  <script>
    // ======= State =======
    const state = {
      phase: "askValentine", // askValentine -> askForever -> springForever -> disaster
      showerRunning: false,
      bgParticleLoop: null,
      audioStarted: false,
      audioCtx: null,
      musicNodes: null
    };

    // ======= DOM =======
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const foreverYesBtn = document.getElementById("foreverYesBtn");
    const foreverNoBtn = document.getElementById("foreverNoBtn");
    const mainButtons = document.getElementById("mainButtons");
    const foreverButtons = document.getElementById("foreverButtons");

    const msg = document.getElementById("msg");
    const question = document.getElementById("question");
    const subtitle = document.getElementById("subtitle");

    const overlay = document.getElementById("overlay");
    const reconsiderBtn = document.getElementById("reconsiderBtn");
    const stillNoBtn = document.getElementById("stillNoBtn");
    const noLine = document.getElementById("noLine");

    const bgParticles = document.getElementById("bgParticles");
    const disasterOverlay = document.getElementById("disasterOverlay");
    const card = document.getElementById("card");
    const boomText = document.getElementById("boomText");

    const musicStatus = document.getElementById("musicStatus");

    // ======= Helpers =======
    function rand(min, max){ return Math.random() * (max - min) + min; }
    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    // ======= Subtle fun music (WebAudio) =======
    // Starts on first button click to satisfy autoplay rules.
    function startMusicIfNeeded(){
      if (state.audioStarted) return;

      const AudioContext = window.AudioContext || window.webkitAudioContext;
      if (!AudioContext) {
        musicStatus.textContent = "Music: unavailable (browser doesn‚Äôt support)";
        return;
      }

      const ctx = new AudioContext();
      state.audioCtx = ctx;

      const master = ctx.createGain();
      master.gain.value = 0.035; // VERY subtle
      master.connect(ctx.destination);

      // a tiny ‚Äútoy‚Äù chord pad (soft triangle)
      const pad = ctx.createOscillator();
      pad.type = "triangle";
      const padGain = ctx.createGain();
      padGain.gain.value = 0.0;

      // a gentle ‚Äúplucky‚Äù sine for melody
      const lead = ctx.createOscillator();
      lead.type = "sine";
      const leadGain = ctx.createGain();
      leadGain.gain.value = 0.0;

      // soft filter to warm it up
      const filter = ctx.createBiquadFilter();
      filter.type = "lowpass";
      filter.frequency.value = 1200;

      pad.connect(filter);
      lead.connect(filter);
      filter.connect(master);

      pad.start();
      lead.start();

      // Schedule a simple, cute motif
      const tempo = 92; // bpm
      const beat = 60 / tempo;

      // Chords (A major-ish feel): A, D, E, D
      const chords = [
        [220, 277.18, 329.63], // A
        [293.66, 369.99, 440], // D
        [329.63, 415.30, 493.88], // E
        [293.66, 369.99, 440]  // D
      ];

      // Melody notes (Hz) simple and playful
      const melody = [440, 493.88, 523.25, 493.88, 440, 392, 440, 0];

      function ramp(g, to, t){
        g.gain.cancelScheduledValues(t);
        g.gain.setValueAtTime(g.gain.value, t);
        g.gain.linearRampToValueAtTime(to, t + 0.03);
      }

      let t0 = ctx.currentTime + 0.05;

      function loop(){
        // Pad: fake chord by cycling frequencies quickly
        const chord = chords[Math.floor((t0/ (beat*4)) ) % chords.length];

        // Pad swell
        ramp(padGain, 0.018, t0);
        padGain.gain.linearRampToValueAtTime(0.010, t0 + beat*2);
        padGain.gain.linearRampToValueAtTime(0.000, t0 + beat*4 - 0.02);

        // attach gains
        pad.disconnect();
        pad.connect(padGain);
        padGain.connect(filter);

        // arpeggiate chord within 4 beats
        for (let i=0;i<12;i++){
          const tt = t0 + (i * (beat*4/12));
          const f = chord[i % chord.length] * (i % 2 === 0 ? 1 : 2);
          pad.frequency.setValueAtTime(f, tt);
        }

        // Lead melody: tiny plucks each beat
        lead.disconnect();
        lead.connect(leadGain);
        leadGain.connect(filter);

        for (let i=0;i<8;i++){
          const tt = t0 + i*beat;
          const note = melody[i];
          if (note === 0) continue;
          lead.frequency.setValueAtTime(note, tt);

          // pluck envelope
          leadGain.gain.setValueAtTime(0.0, tt);
          leadGain.gain.linearRampToValueAtTime(0.020, tt + 0.02);
          leadGain.gain.linearRampToValueAtTime(0.000, tt + 0.18);
        }

        t0 += beat*8;

        // keep scheduling ahead
        if (state.audioStarted) {
          state.musicNodes.loopTimer = setTimeout(loop, beat*8*1000 * 0.85);
        }
      }

      state.musicNodes = { master, filter, pad, padGain, lead, leadGain, loopTimer:null };
      state.audioStarted = true;
      musicStatus.textContent = "Music: on (subtle + fun) üé∂";

      // start loop
      loop();
    }

    function stopMusicHard(){
      try{
        if (state.musicNodes?.loopTimer) clearTimeout(state.musicNodes.loopTimer);
        if (state.audioCtx){
          state.audioCtx.close();
        }
      }catch(e){}
      state.audioStarted = false;
      musicStatus.textContent = "Music: off";
    }

    // ======= Foreground celebration shower =======
    function startShower(intensity = 120, durationMs = 6000) {
      if (state.showerRunning) return;
      state.showerRunning = true;

      const emojis = ["üíñ","üíò","üíï","üíù","‚ù§Ô∏è","üòç","ü•∞","‚ú®","üòò","üíû","üå∏","ü´∂"];

      // burst
      for (let i = 0; i < intensity; i++) {
        setTimeout(() => spawnFloat(pick(emojis)), i * 32);
      }

      // gentle stream
      const interval = setInterval(() => {
        for (let i = 0; i < 6; i++) spawnFloat(pick(emojis), true);
      }, 260);

      setTimeout(() => clearInterval(interval), durationMs);
      setTimeout(() => (state.showerRunning = false), durationMs + 350);
    }

    function spawnFloat(char, softer=false) {
      const el = document.createElement("div");
      el.className = "float";
      el.textContent = char;

      const startX = Math.random() * 100; // vw
      const size = rand(18, softer ? 26 : 34);
      el.style.left = startX + "vw";
      el.style.fontSize = size + "px";
      document.body.appendChild(el);

      const drift = rand(-16, 16);
      const duration = rand(2400, 5200);
      const rotate = rand(-180, 180);

      const startY = -12;
      const endY = 112;
      const start = performance.now();

      function tick(now) {
        const t = Math.min(1, (now - start) / duration);
        const ease = 1 - Math.pow(1 - t, 3);

        const x = startX + drift * ease;
        const y = startY + (endY - startY) * ease;
        const r = rotate * ease;

        el.style.transform = `translate(${x}vw, ${y}vh) rotate(${r}deg)`;
        el.style.opacity = String(1 - t * 0.9);

        if (t < 1) requestAnimationFrame(tick);
        else el.remove();
      }

      requestAnimationFrame(tick);
    }

    // ======= Background particle drizzle (spring mode) =======
    function startBgParticles(){
      if (state.bgParticleLoop) return;

      const chars = ["üíó","üíï","‚ú®","üå∏","üíû","ü´∂"];
      state.bgParticleLoop = setInterval(() => {
        // spawn a few per cycle
        for (let i=0;i<3;i++){
          const el = document.createElement("div");
          el.className = "bgP";
          el.textContent = pick(chars);

          const startX = rand(-5, 105);
          const size = rand(14, 24);
          el.style.left = startX + "vw";
          el.style.fontSize = size + "px";

          bgParticles.appendChild(el);

          const drift = rand(-10, 10);
          const duration = rand(7000, 12000);
          const rot = rand(-120, 120);
          const start = performance.now();

          function tick(now){
            const t = Math.min(1, (now - start) / duration);
            const ease = 1 - Math.pow(1 - t, 2);

            const x = startX + drift * ease;
            const y = (-12) + (125) * ease;

            el.style.transform = `translate(${x}vw, ${y}vh) rotate(${rot*ease}deg)`;
            el.style.opacity = String(0.85 - t * 0.75);

            if (t < 1) requestAnimationFrame(tick);
            else el.remove();
          }

          requestAnimationFrame(tick);
        }
      }, 520);
    }

    function stopBgParticles(){
      if (state.bgParticleLoop){
        clearInterval(state.bgParticleLoop);
        state.bgParticleLoop = null;
      }
      bgParticles.innerHTML = "";
    }

    // ======= Disaster mode effects =======
    function spawnMeteor(){
      const m = document.createElement("div");
      m.className = "meteor";
      const startX = rand(10, 110);
      const startY = rand(-10, 40);
      m.style.left = startX + "vw";
      m.style.top = startY + "vh";
      m.style.transform = "rotate(215deg)";
      document.body.appendChild(m);

      const duration = rand(600, 1100);
      const start = performance.now();

      function tick(now){
        const t = Math.min(1, (now - start) / duration);
        const x = startX - 55 * t;
        const y = startY + 55 * t;
        m.style.left = x + "vw";
        m.style.top = y + "vh";
        m.style.opacity = String(1 - t);
        if (t < 1) requestAnimationFrame(tick);
        else m.remove();
      }
      requestAnimationFrame(tick);
    }

    function triggerDisaster(){
      state.phase = "disaster";
      document.body.classList.add("disaster");
      disasterOverlay.classList.add("active");
      stopBgParticles();

      msg.textContent = "‚Ä¶okay. initiating catastrophic heartbreak protocol üíî";
      msg.style.color = "var(--danger)";
      subtitle.textContent = "This is not a drill.";

      // shake everything
      card.classList.add("shake");
      document.getElementById("scene").classList.add("shake");

      // meteors
      const meteorStorm = setInterval(spawnMeteor, 180);

      // crescendo visuals then BOOM
      setTimeout(() => {
        clearInterval(meteorStorm);

        // final boom: stop shaking
        card.classList.remove("shake");
        document.getElementById("scene").classList.remove("shake");

        boomText.classList.add("active");
        startShower(80, 2500); // chaotic shower
        setTimeout(() => boomText.classList.remove("active"), 5200);
      }, 2600);
    }

    // ======= Flow controls =======
    function showForeverQuestion(){
      state.phase = "askForever";
      mainButtons.style.display = "none";
      foreverButtons.style.display = "flex";

      question.textContent = "Okay then‚Ä¶ will you be my Valentine forever? üíçüíû";
      subtitle.textContent = "No pressure. (Only a tiny, adorable amount.)";
      msg.textContent = "You said YES!! üò≠üíñ I‚Äôm officially smiling like an idiot.";
      msg.style.color = "#ff2d6d";

      startShower(140, 5200);
    }

    function enterSpringForever(){
      state.phase = "springForever";
      document.body.classList.add("spring");
      question.textContent = "It‚Äôs official: love mode activated üå∏üíñ";
      subtitle.textContent = "Spring romance, soft skies, and too much cute to handle.";
      msg.textContent = "Tasnim Jahan, you just upgraded my whole universe ü´∂‚ú®";
      msg.style.color = "#ff2d6d";

      startBgParticles();
      startShower(160, 6500);

      // keep forever buttons but disable them
      foreverYesBtn.disabled = true;
      foreverNoBtn.disabled = true;
    }

    function openNoModal(firstNo=true){
      overlay.style.display = "grid";
      if (firstNo){
        noLine.textContent = "Are you sure? ü•∫ I‚Äôll be a little sad‚Ä¶ like a kitten in the rain.";
      } else {
        noLine.textContent = "Final answer? This may trigger‚Ä¶ consequences. üò∂";
      }
    }

    // ======= Button handlers =======
    function onAnyClickStartAudio(){
      startMusicIfNeeded();
    }

    yesBtn.addEventListener("click", () => {
      onAnyClickStartAudio();
      overlay.style.display = "none";

      // First yes -> ask forever
      if (state.phase === "askValentine"){
        showForeverQuestion();
      }
    });

    noBtn.addEventListener("click", () => {
      onAnyClickStartAudio();
      openNoModal(true);
    });

    reconsiderBtn.addEventListener("click", () => {
      onAnyClickStartAudio();
      overlay.style.display = "none";

      // reconsider -> treat as YES for current phase
      if (state.phase === "askValentine"){
        showForeverQuestion();
      } else if (state.phase === "askForever"){
        enterSpringForever();
      }
    });

    stillNoBtn.addEventListener("click", () => {
      onAnyClickStartAudio();
      overlay.style.display = "none";

      // If they say "Still No" from first prompt -> set phase to askForever? no: keep it, but escalate next time
      msg.textContent = "Okay‚Ä¶ I‚Äôll ask again. Gently. With snacks. üòîüç´";
      msg.style.color = "#444";
      subtitle.textContent = "I respect your decision (but my heart is doing push-ups).";
    });

    foreverYesBtn.addEventListener("click", () => {
      onAnyClickStartAudio();
      overlay.style.display = "none";
      if (state.phase === "askForever"){
        enterSpringForever();
      }
    });

    foreverNoBtn.addEventListener("click", () => {
      onAnyClickStartAudio();
      // Forever question NO -> are you sure (final)
      openNoModal(false);

      // Modify modal buttons meaning for final no:
      reconsiderBtn.textContent = "Okay‚Ä¶ YES, forever üíò";
      stillNoBtn.textContent = "Final No üò∂";

      // One-time override: if stillNo clicked after this, disaster.
      const handler = () => {
        stillNoBtn.removeEventListener("click", handler, true);
        // disaster on final no
        triggerDisaster();
      };
      stillNoBtn.addEventListener("click", handler, true);
    });

    // Close modal when clicking outside
    overlay.addEventListener("click", (e) => {
      if (e.target === overlay) overlay.style.display = "none";
    });

    // Start gentle background particles in normal mode? keep off for clean look.
    // (Spring mode starts them.)
  </script>
</body>
</html>
